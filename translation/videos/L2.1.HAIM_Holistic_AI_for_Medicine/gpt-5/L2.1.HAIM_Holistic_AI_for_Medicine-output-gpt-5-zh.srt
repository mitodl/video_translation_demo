1
00:00:00,000 --> 00:00:02,120
讲师：在本次课程中，我们将介绍

2
00:00:02,120 --> 00:00:08,400
医学整体人工智能，简称 HAIM。

3
00:00:08,400 --> 00:00:11,900
Haim 是希伯来语中“生命”的意思。

4
00:00:11,900 --> 00:00:17,660
它代表了多模态人工智能在医学中的一种应用。

5
00:00:17,660 --> 00:00:19,800
本次课程的提纲如下。

6
00:00:19,800 --> 00:00:23,670
我们首先给出使用多模态 AI 的动机。

7
00:00:23,670 --> 00:00:27,110
然后我们介绍 HAIM 并将其应用

8
00:00:27,110 --> 00:00:31,880
于哈特福德医疗系统的真实世界环境中。

9
00:00:31,880 --> 00:00:35,030
最后，我们以 HAIM 的应用作结，

10
00:00:35,030 --> 00:00:38,960
涵盖医学的其他若干领域。

11
00:00:38,960 --> 00:00:42,260
为了说明多模态的动机，

12
00:00:42,260 --> 00:00:45,920
让我们思考医生是如何做决策的。

13
00:00:45,920 --> 00:00:52,520
他们使用影像、MRI、CT、X 光等；语言，

14
00:00:52,520 --> 00:00:56,670
放射科报告、医师或护士的笔记；

15
00:00:56,670 --> 00:01:00,200
表格数据，比如电子病历；

16
00:01:00,200 --> 00:01:04,290
时间序列；以及基因组信息。

17
00:01:04,290 --> 00:01:07,870
既然人类医生使用多模态数据，

18
00:01:07,870 --> 00:01:10,770
很自然就会问，机器

19
00:01:10,770 --> 00:01:16,680
能否使用多模态数据来进行医疗诊断和决策。

20
00:01:16,680 --> 00:01:22,770
考虑一下人类用来理解世界的传感器。

21
00:01:22,770 --> 00:01:26,220
人类使用五种基本感官——

22
00:01:26,220 --> 00:01:32,850
触觉、视觉、听觉、嗅觉和味觉。

23
00:01:32,850 --> 00:01:36,390
换言之，多模态是

24
00:01:36,390 --> 00:01:38,070
人类生活的一个基本特征。

25
00:01:38,070 --> 00:01:41,910
因此很自然要思考这样一个问题：

26
00:01:41,910 --> 00:01:48,390
机器是否也应该用于处理多模态数据。

27
00:01:48,390 --> 00:01:52,830
在本次课程中，我们根据一篇 2022 年论文的主要发现来介绍 HAIM，

28
00:01:52,830 --> 00:01:57,960
论文题为“面向医疗保健的集成多模态

29
00:01:57,960 --> 00:02:00,900
人工智能框架”，

30
00:02:00,900 --> 00:02:05,810
发表于 Nature Digital Medicine，

31
00:02:05,810 --> 00:02:10,850
作者为我本人及我课题组成员，发表于 2022 年 9 月。

32
00:02:10,850 --> 00:02:13,520
我想给大家讲一点

33
00:02:13,520 --> 00:02:15,650
HAIM 概念形成的历史。

34
00:02:15,650 --> 00:02:22,160
2013 年，IBM 创建了 Watson，这是一款计算机程序，

35
00:02:22,160 --> 00:02:24,770
可以参加《危险边缘》（Jeopardy）节目，这是一种游戏，

36
00:02:24,770 --> 00:02:29,180
参赛者会得到一个陈述，

37
00:02:29,180 --> 00:02:31,250
她需要用一个问题的形式

38
00:02:31,250 --> 00:02:33,350
来表达答案。

39
00:02:33,350 --> 00:02:38,660
例如，如果答案是“他提出了相对论”，

40
00:02:38,660 --> 00:02:42,710
参赛者要想回答正确，就需要说：

41
00:02:42,710 --> 00:02:44,990
“谁是阿尔伯特·爱因斯坦？”

42
00:02:44,990 --> 00:02:49,490
IBM Watson 与历史上最强的人类选手对战了两天，

43
00:02:49,490 --> 00:02:54,680
并且赢得了压倒性的胜利。

44
00:02:54,680 --> 00:02:58,710
我还记得对此事的兴奋之情，

45
00:02:58,710 --> 00:03:01,220
因为我当时就知道，这是

46
00:03:01,220 --> 00:03:03,910
将机器智能推动到下一个层次

47
00:03:03,910 --> 00:03:06,190
的时代的开始。

48
00:03:06,190 --> 00:03:09,740
IBM 随后将 Watson 应用于医学，

49
00:03:09,740 --> 00:03:12,550
但不幸的是没有成功。

50
00:03:12,550 --> 00:03:15,640
在随后的 12 年中，人工智能

51
00:03:15,640 --> 00:03:19,090
取得了显著进步，尤其是生成式 AI

52
00:03:19,090 --> 00:03:21,460
和大型语言模型。

53
00:03:21,460 --> 00:03:24,970
HAIM 展示了如何结合多种模态，

54
00:03:24,970 --> 00:03:29,170
以实现显著提升的性能。

55
00:03:29,170 --> 00:03:32,780
HAIM 提供了一个 AI 的整体视角——

56
00:03:32,780 --> 00:03:35,000
计算机视觉、自然语言处理、

57
00:03:35,000 --> 00:03:38,170
机器学习——以提升模型

58
00:03:38,170 --> 00:03:40,820
进行预测与处方决策的能力，

59
00:03:40,820 --> 00:03:44,230
尤其是在医学领域。

60
00:03:44,230 --> 00:03:47,560
传统的机器学习范式

61
00:03:47,560 --> 00:03:51,400
是使用表格数据来进行预测。

62
00:03:51,400 --> 00:03:53,780
当存在多种模态时，

63
00:03:53,780 --> 00:03:56,480
比如计算机视觉或语言，

64
00:03:56,480 --> 00:03:58,690
这种范式就不适用，我们

65
00:03:58,690 --> 00:04:02,170
需要探索不同的数据融合方式。

66
00:04:02,170 --> 00:04:04,610
在接下来的幻灯片中，我们将概述如何

67
00:04:04,610 --> 00:04:08,450
结合不同模态的数据。

68
00:04:08,450 --> 00:04:11,850
当存在电子健康数据时，

69
00:04:11,850 --> 00:04:16,560
如幻灯片所示，我们保持记录的原样，

70
00:04:16,560 --> 00:04:19,138
即保持传统机器学习格式，

71
00:04:19,138 --> 00:04:23,120
可应用传统方法。

72
00:04:23,120 --> 00:04:26,070
当有时间序列可用时，

73
00:04:26,070 --> 00:04:29,790
我们使用像 tsfresh 这样的软件——

74
00:04:29,790 --> 00:04:31,880
你们将在习题课中看到——

75
00:04:31,880 --> 00:04:34,640
来提取时间序列的特征，

76
00:04:34,640 --> 00:04:38,340
比如最大值、最小值、中位数、

77
00:04:38,340 --> 00:04:41,840
均值、峰值个数，等等许多特征。

78
00:04:41,840 --> 00:04:45,860
这样，时间序列就被用若干数值加以概括，

79
00:04:45,860 --> 00:04:50,390
作为传统机器学习格式的输入。

80
00:04:50,390 --> 00:04:53,210
当输入是医生或护士的

81
00:04:53,210 --> 00:04:57,000
笔记，或放射科报告，也就是语言时，

82
00:04:57,000 --> 00:05:00,680
我们使用像 ClinicalBERT 这样的基础模型。

83
00:05:00,680 --> 00:05:04,410
它将语言信息概括为

84
00:05:04,410 --> 00:05:09,420
一个嵌入，即一个包含 768 个元素的向量。

85
00:05:09,420 --> 00:05:12,090
该向量将信息

86
00:05:12,090 --> 00:05:15,750
以数值格式加以概括，从而可以与

87
00:05:15,750 --> 00:05:18,510
其他数值特征结合。

88
00:05:18,510 --> 00:05:20,940
请注意，我们可以使用生成式 AI

89
00:05:20,940 --> 00:05:28,530
模型，比如 OpenAI 4.0 或 Llama，来替代 ClinicalBERT。

90
00:05:28,530 --> 00:05:31,870
当输入是心电图时，

91
00:05:31,870 --> 00:05:36,510
我们使用 EKG 中包含的语言信息，

92
00:05:36,510 --> 00:05:41,370
像处理语言一样，然后使用像

93
00:05:41,370 --> 00:05:43,260
ClinicalBERT 这样的基础模型，就像我们先前所见，

94
00:05:43,260 --> 00:05:46,770
它将语言信息概括为

95
00:05:46,770 --> 00:05:51,610
一个嵌入，即一个包含 768 个元素的向量，以数值格式表示，

96
00:05:51,610 --> 00:05:54,300
与之前相同。

97
00:05:54,300 --> 00:05:57,790
当输入是一幅图像，比如一张 X 光片时，

98
00:05:57,790 --> 00:06:02,820
我们使用卷积神经网络提取一个嵌入，

99
00:06:02,820 --> 00:06:07,050
即一个包含 768 个元素的向量，以数值格式表示。

100
00:06:07,050 --> 00:06:12,300
请注意，我们可以使用来自生成式 AI 模型的嵌入，

101
00:06:12,300 --> 00:06:19,590
而不是使用来自 CNN 模型的图像作为替代。

102
00:06:19,590 --> 00:06:22,470
这是本次讲座的关键思想。

103
00:06:22,470 --> 00:06:26,520
我们使用我们开发的数值特征，可以直接使用，

104
00:06:26,520 --> 00:06:29,020
来自电子医疗保健记录，

105
00:06:29,020 --> 00:06:32,730
或者从时间序列或嵌入中提取的特征，

106
00:06:32,730 --> 00:06:34,830
利用非结构化数据。

107
00:06:34,830 --> 00:06:37,470
这个理念称为融合（fusion）。

108
00:06:37,470 --> 00:06:41,080
我们现在有一个传统的机器学习任务。

109
00:06:41,080 --> 00:06:45,330
我们想要预测，例如，死亡率，使用

110
00:06:45,330 --> 00:06:48,510
作为输入我们提取的数值特征，

111
00:06:48,510 --> 00:06:50,230
如前所述。

112
00:06:50,230 --> 00:06:54,510
我们使用传统的机器学习模型，如 XGBoost 或随机森林，

113
00:06:54,510 --> 00:06:58,620
来执行这一预测任务。

114
00:06:58,620 --> 00:07:01,140
请注意，该方法非常通用，

115
00:07:01,140 --> 00:07:04,180
因为我们将每种模态独立对待，

116
00:07:04,180 --> 00:07:07,660
因此如果我们添加新的模态，

117
00:07:07,660 --> 00:07:11,050
我们只需添加额外的嵌入。

118
00:07:11,050 --> 00:07:15,730
注意我们并不把这些模态组合起来训练。

119
00:07:15,730 --> 00:07:19,000
还要注意这些嵌入并不取决于

120
00:07:19,000 --> 00:07:21,880
我们想要执行的任务。

121
00:07:21,880 --> 00:07:24,460
这些嵌入只是对数据进行概括，

122
00:07:24,460 --> 00:07:29,860
对每种模态而言独立于我们想要执行的任务。

123
00:07:29,860 --> 00:07:34,780
现在让我们用 HAIM 来进行各种预测任务，使用

124
00:07:34,780 --> 00:07:38,860
来自 Beth Israel Deaconess Medical

125
00:07:38,860 --> 00:07:43,540
Center（位于马萨诸塞州波士顿的一家医院系统）的 MIMIC-IV 数据集。

126
00:07:43,540 --> 00:07:51,490
该数据集包含 34,537 条患者记录，来自

127
00:07:51,490 --> 00:07:54,850
急诊 ICU 病房。

128
00:07:54,850 --> 00:07:57,940
这些记录包括胸部 X 光片、

129
00:07:57,940 --> 00:08:03,310
电子病历、放射学报告和心电图（EKG）。

130
00:08:03,310 --> 00:08:09,500
也就是说，它包含视觉、语言和表格数据。

131
00:08:09,500 --> 00:08:12,600
我们的目标诊断包括 12 个目标——

132
00:08:12,600 --> 00:08:14,990
死亡率预测，也就是说，我们

133
00:08:14,990 --> 00:08:19,310
旨在预测患者是否死亡或被送往临终关怀，

134
00:08:19,310 --> 00:08:25,130
或者患者在出院时仍然存活；其一，

135
00:08:25,130 --> 00:08:29,810
在 10 种诊断中的一种，也就是我们要预测患者是否患有

136
00:08:29,810 --> 00:08:37,429
某种疾病，如骨折、肺部病灶、心脏扩大、

137
00:08:37,429 --> 00:08:43,580
实变、肺炎、[听不清] 分类、肺

138
00:08:43,580 --> 00:08:49,940
容量、气胸、水肿、心脏肥大；最后，

139
00:08:49,940 --> 00:08:52,670
住院时长，也就是我们想要

140
00:08:52,670 --> 00:08:58,340
预测患者是否会在 48 小时内出院。

141
00:08:58,340 --> 00:09:01,310
我们比较了 HAIM 的表现

142
00:09:01,310 --> 00:09:04,740
与一种仅基于电子病历的经典机器学习模型的表现，

143
00:09:04,740 --> 00:09:08,200
即经典方法。

144
00:09:08,200 --> 00:09:10,020
在死亡率方面，HAIM 将准确率提高了 11% 到 33%，

145
00:09:10,020 --> 00:09:16,650
相较于仅使用电子病历。

146
00:09:16,650 --> 00:09:19,120
那是仅基于经典机器学习模型的方法。

147
00:09:19,120 --> 00:09:22,350
在疾病分类方面，HAIM 将准确率提高了

148
00:09:22,350 --> 00:09:25,860
6% 到 22%，相较于电子病历。

149
00:09:25,860 --> 00:09:30,630
在住院时长方面，HAIM 将准确率提高了 8% 到 20%，

150
00:09:30,630 --> 00:09:34,890
相较于电子病历

151
00:09:34,890 --> 00:09:37,050
以及更为经典的机器学习模型。

152
00:09:37,050 --> 00:09:39,840
在所有情况下，多模态的使用

153
00:09:39,840 --> 00:09:42,780
都带来了显著的性能提升。

154
00:09:42,780 --> 00:09:47,460
在这一页幻灯片中，我们呈现了子分析，

155
00:09:47,460 --> 00:09:51,300
以便理解每种模态对

156
00:09:51,300 --> 00:09:54,900
疾病分类预测的相对贡献。

157
00:09:54,900 --> 00:09:58,270
视觉输入，在这个例子中是 X 光片，

158
00:09:58,270 --> 00:10:00,810
是占主导地位的模态。

159
00:10:00,810 --> 00:10:02,820
对于住院时长和死亡率，

160
00:10:02,820 --> 00:10:05,300
时间序列和电子病历

161
00:10:05,300 --> 00:10:10,990
是占主导地位的模态。

162
00:10:10,990 --> 00:10:13,900
接下来我们展示 HAIM 方法在一个应用中的使用，

163
00:10:13,900 --> 00:10:18,040
用于预测 Hartford HealthCare 系统的住院时长，

164
00:10:18,040 --> 00:10:22,570
简称 HHC，它是康涅狄格州最大的医院系统，

165
00:10:22,570 --> 00:10:28,510
每年营业收入超过 50 亿美元，

166
00:10:28,510 --> 00:10:32,080
拥有七家多元化医院，从一所学术型城市医院

167
00:10:32,080 --> 00:10:37,300
到一所社区医院，并且从大型到小型医院兼而有之。

168
00:10:37,300 --> 00:10:41,180
总体而言，HHC 共拥有 2,500 张床位。

169
00:10:41,180 --> 00:10:45,590
它代表了一个高质量、典型的美国

170
00:10:45,590 --> 00:10:49,900
医院网络。

171
00:10:49,900 --> 00:10:52,660
我们已经将我们介绍的一些算法落地到一家名为

172
00:10:52,660 --> 00:10:56,170
Holistic Hospital Optimization 的公司，

173
00:10:56,170 --> 00:11:00,020
简称 H2O。

174
00:11:00,020 --> 00:11:02,350
这也体现了与生命基本要素——水——之间的联系。

175
00:11:02,350 --> 00:11:04,420
我们将详细讨论住院时长这一应用。

176
00:11:04,420 --> 00:11:07,840
我们还实现了其他应用，

177
00:11:07,840 --> 00:11:11,140
比如一个恶化指数，其中包括死亡风险、ICU

178
00:11:11,140 --> 00:11:13,330
风险、护士排班和手术室排班。

179
00:11:13,330 --> 00:11:17,230
该软件由数百名用户使用——

180
00:11:17,230 --> 00:11:21,670
医生、护士、管理人员。

181
00:11:21,670 --> 00:11:24,580
它在 HHC 所有七家医院运行，

182
00:11:24,580 --> 00:11:27,800
并带来了每年数千万美元的收入提升。

183
00:11:27,800 --> 00:11:31,780
我们已将这些解决方案部署到

184
00:11:31,780 --> 00:11:35,710
全球其他若干医院系统。

185
00:11:35,710 --> 00:11:37,390
这些应用包括预测

186
00:11:37,390 --> 00:11:39,070
未来 24 或 48 小时内的出院，这

187
00:11:39,070 --> 00:11:43,210
对于识别和优先安排患者很重要，

188
00:11:43,210 --> 00:11:45,310
缩短住院时长并节省成本，

189
00:11:45,310 --> 00:11:49,060
为治疗和处置方案做准备。

190
00:11:49,060 --> 00:11:52,880
它还会预测出院后的最终去向、

191
00:11:52,880 --> 00:11:56,690
死亡风险，

192
00:11:56,690 --> 00:12:00,490
以及需要进入重症监护

193
00:12:00,490 --> 00:12:03,100
病房的风险。

194
00:12:03,100 --> 00:12:06,050
这些预测有助于预警患者病情恶化，

195
00:12:06,050 --> 00:12:09,350
以及更有效地分配医院资源。

196
00:12:09,350 --> 00:12:10,730
该表显示了 AUC（曲线下面积），

197
00:12:10,730 --> 00:12:16,340
用于死亡率、去向、24 小时和 48 小时出院，

198
00:12:28,670 --> 00:12:33,080
预测所有七家医院的进入ICU或离开ICU

199
00:12:33,080 --> 00:12:37,700
位于HHC的医院。

200
00:12:37,700 --> 00:12:41,810
结果在所有预测

201
00:12:41,810 --> 00:12:44,330
和所有医院中都可靠地强劲。

202
00:12:44,330 --> 00:12:47,720
接下来我们展示校准图也

203
00:12:47,720 --> 00:12:49,160
非常准确。

204
00:12:49,160 --> 00:12:52,980
具体而言，在左侧图的横轴上，

205
00:12:52,980 --> 00:12:56,420
我们绘制具有以下概率的患者所占比例：

206
00:12:56,420 --> 00:13:01,020
48小时出院的概率介于比如说0.5到0.6之间，

207
00:13:01,020 --> 00:13:06,180
以10%的增量，然后在纵轴上绘制

208
00:13:06,180 --> 00:13:09,990
在这些患者中于48小时内出院者所占的比例

209
00:13:09,990 --> 00:13:11,250
的比例。

210
00:13:11,250 --> 00:13:15,250
这条线非常接近45度角，

211
00:13:15,250 --> 00:13:19,380
说明预测的概率与

212
00:13:19,380 --> 00:13:21,360
经验证据高度一致。

213
00:13:21,360 --> 00:13:25,570
在右侧图中，我们看到了关于死亡率的校准图。

214
00:13:25,570 --> 00:13:29,490
同样，校准非常准确。

215
00:13:29,490 --> 00:13:32,220
该图展示了已在

216
00:13:32,220 --> 00:13:34,960
HHC实施的软件。

217
00:13:34,960 --> 00:13:38,740
这些颜色传达以下信息。

218
00:13:38,740 --> 00:13:41,460
绿色表明该患者需要

219
00:13:41,460 --> 00:13:43,720
被优先安排出院。

220
00:13:43,720 --> 00:13:47,550
黄色也表示医院工作人员

221
00:13:47,550 --> 00:13:51,190
需要做准备，但强度不必相同。

222
00:13:51,190 --> 00:13:55,470
红色表示患者正在恶化。

223
00:13:55,470 --> 00:13:58,530
请注意，如果接下来24小时或48小时内

224
00:13:58,530 --> 00:14:02,530
的出院概率

225
00:14:02,530 --> 00:14:04,740
超过50%，我们会发出绿色警报。

226
00:14:04,740 --> 00:14:10,360
当48小时出院概率

227
00:14:10,360 --> 00:14:16,660
在35%到50%之间，且与前一天相比概率增加超过

228
00:14:16,660 --> 00:14:19,870
10%时，会出现黄色警报。

229
00:14:19,870 --> 00:14:23,230
该软件还绘制一个子图，

230
00:14:23,230 --> 00:14:26,530
展示不同因素如何影响住院时长。

231
00:14:26,530 --> 00:14:32,020
这样一来，预测就更加可解释。

232
00:14:32,020 --> 00:14:36,160
与人类医生相比，这种人工智能方法

233
00:14:36,160 --> 00:14:40,690
具有显著更高的AUC，能够识别

234
00:14:40,690 --> 00:14:42,910
更多可以出院的患者，

235
00:14:42,910 --> 00:14:45,490
并做出更准确的预测。

236
00:14:45,490 --> 00:14:49,750
显然，AI的优势是显著的。

237
00:14:49,750 --> 00:14:54,670
我们进行了一项测试，其中HHC的某些病区

238
00:14:54,670 --> 00:14:57,940
使用了该软件，并将其与

239
00:14:57,940 --> 00:14:59,390
未使用的软件的病区进行比较。

240
00:14:59,390 --> 00:15:02,050
我们发现，使用该软件的病区

241
00:15:02,050 --> 00:15:05,440
患者的平均住院时长

242
00:15:05,440 --> 00:15:14,350
减少了0.67天，从565天降至498天。

243
00:15:14,350 --> 00:15:16,480
这表明我们将住院时长减少了

244
00:15:16,480 --> 00:15:20,500
大约15%，从而

245
00:15:20,500 --> 00:15:24,070
可以按相应幅度提高吞吐量，

246
00:15:24,070 --> 00:15:27,430
进而将医院的总体收入

247
00:15:27,430 --> 00:15:31,180
每年增加数千万。

248
00:15:31,180 --> 00:15:35,650
HAIM在多种应用中具有广泛适用性。

249
00:15:35,650 --> 00:15:40,180
当前工作的例子包括在布莱根妇女医院检测家庭虐待，

250
00:15:40,180 --> 00:15:43,780
在布莱根妇女医院进行自动检测，

251
00:15:43,780 --> 00:15:47,110
来自病程记录、影像扫描和检验的数据，

252
00:15:47,110 --> 00:15:54,460
在马萨诸塞总医院-布莱根，哈特福德

253
00:15:54,460 --> 00:15:57,980
医院进行心电图的统一诊断、检出硬膜下血肿，

254
00:15:57,980 --> 00:16:00,830
以及所谓的AI伴侣。

255
00:16:00,830 --> 00:16:06,460
我们利用HAIM向医生和护士就

256
00:16:06,460 --> 00:16:08,310
诊断提供建议。

