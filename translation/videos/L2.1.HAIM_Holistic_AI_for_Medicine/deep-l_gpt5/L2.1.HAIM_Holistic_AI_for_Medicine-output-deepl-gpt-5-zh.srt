1
00:00:00,000 --> 00:00:02,120
教师：在本讲座中，我们将介绍

2
00:00:02,120 --> 00:00:08,400
面向医学的整体人工智能，简称 HAIM。

3
00:00:08,400 --> 00:00:11,900
“Haim”在希伯来语中意为“生命”。

4
00:00:11,900 --> 00:00:17,660
它代表了多模态人工智能在医学中的一种应用。

5
00:00:17,660 --> 00:00:19,800
本次讲座的提纲如下。

6
00:00:19,800 --> 00:00:23,670
我们首先阐述使用多模态人工智能的动机。

7
00:00:23,670 --> 00:00:27,110
然后我们介绍 HAIM，并将其应用……

8
00:00:27,110 --> 00:00:31,880
……于哈特福德医疗保健系统的真实环境中。

9
00:00:31,880 --> 00:00:35,030
最后，我们将以 HAIM 的应用作结，

10
00:00:35,030 --> 00:00:38,960
涉及医学中的若干其他领域。

11
00:00:38,960 --> 00:00:42,260
为了说明多模态的必要性，

12
00:00:42,260 --> 00:00:45,920
让我们想想临床医生是如何做出决策的。

13
00:00:45,920 --> 00:00:52,520
让我们想想医生是如何做出决定的。

14
00:00:52,520 --> 00:00:56,670
他们利用扫描、核磁共振成像、CT、X 光等；语言、

15
00:00:56,670 --> 00:01:00,200
放射报告、医生或护士笔记；

16
00:01:00,200 --> 00:01:04,290
例如，表格数据、电子病历；

17
00:01:04,290 --> 00:01:07,870
时间序列；以及基因组信息。

18
00:01:07,870 --> 00:01:10,770
鉴于人类医生使用多模态数据、

19
00:01:10,770 --> 00:01:16,680
我们自然会问，机器

20
00:01:16,680 --> 00:01:22,770
可以使用多模态数据进行医疗诊断和决策。

21
00:01:22,770 --> 00:01:26,220
考虑一下人类用来了解世界的传感器。

22
00:01:26,220 --> 00:01:32,850
人们使用人类的五种基本感官--

23
00:01:32,850 --> 00:01:36,390
触觉、视觉、听觉、嗅觉和味觉。

24
00:01:36,390 --> 00:01:38,070
人类生活的基本特征。

25
00:01:38,070 --> 00:01:41,910
人的生命。

26
00:01:41,910 --> 00:01:48,390
因此，自然要考虑以下问题

27
00:01:48,390 --> 00:01:52,830
是否也应使用机器处理多模态数据。

28
00:01:52,830 --> 00:01:57,960
一篇发表于 2022 年、题为“面向医疗保健应用的集成多模态人工智能框架”的论文

29
00:01:57,960 --> 00:02:00,900
的 2022 号文件，题为 "综合多式联运"。

30
00:02:00,900 --> 00:02:05,810
发表在《Nature Digital Medicine》（《自然·数字医学》）的论文，

31
00:02:05,810 --> 00:02:10,850
出现在《自然-数字医学》上的应用"，《自然-数字医学》，2011 年。

32
00:02:10,850 --> 00:02:13,520
2022 年 9 月，由我本人和我的研究小组成员完成。

33
00:02:13,520 --> 00:02:15,650
HAIM 概念的孕育与形成。

34
00:02:15,650 --> 00:02:22,160
的概念。

35
00:02:22,160 --> 00:02:24,770
能参加《危险边缘》（Jeopardy!）这档智力竞赛节目

36
00:02:24,770 --> 00:02:29,180
可以在 "危险 "游戏中竞争

37
00:02:29,180 --> 00:02:31,250
向参赛者提供一份声明

38
00:02:31,250 --> 00:02:33,350
她需要表达答案

39
00:02:33,350 --> 00:02:38,660
例如，如果“答案”是“他提出了相对论”，

40
00:02:38,660 --> 00:02:42,710
例如，如果答案是 "他提出了以下理论

41
00:02:42,710 --> 00:02:44,990
相对论"，选手需要说出正确的

42
00:02:44,990 --> 00:02:49,490
回答 "谁是阿尔伯特-爱因斯坦"？

43
00:02:49,490 --> 00:02:54,680
IBM 沃森与史上最优秀的人类选手同台竞技

44
00:02:54,680 --> 00:02:58,710
我至今仍记得当时的激动，

45
00:02:58,710 --> 00:03:01,220
我还记得这次活动的激动人心之处、

46
00:03:01,220 --> 00:03:03,910
因为我当时就知道，这标志着机器智能迈向新台阶的时代开始了。

47
00:03:03,910 --> 00:03:06,190
推进器时代的开端

48
00:03:06,190 --> 00:03:09,740
智能更上一层楼。

49
00:03:09,740 --> 00:03:12,550
IBM 开始将沃森应用于医疗领域、

50
00:03:12,550 --> 00:03:15,640
可惜没有成功。

51
00:03:15,640 --> 00:03:19,090
在这 12 年间，人工智能

52
00:03:19,090 --> 00:03:21,460
尤其是生成式人工智能

53
00:03:21,460 --> 00:03:24,970
和大型语言模型。

54
00:03:24,970 --> 00:03:29,170
HAIM 展示了如何结合各种模式

55
00:03:29,170 --> 00:03:32,780
以大幅提高性能。

56
00:03:32,780 --> 00:03:35,000
HAIM 从整体角度介绍了人工智能--

57
00:03:35,000 --> 00:03:38,170
计算机视觉、自然语言处理

58
00:03:38,170 --> 00:03:40,820
机器学习--提高模型的能力

59
00:03:40,820 --> 00:03:44,230
进行预测并开出处方、

60
00:03:44,230 --> 00:03:47,560
特别是在医学方面。

61
00:03:47,560 --> 00:03:51,400
传统的机器学习模式

62
00:03:51,400 --> 00:03:53,780
就是使用表格数据进行预测。

63
00:03:53,780 --> 00:03:56,480
当存在多种模式时、

64
00:03:56,480 --> 00:03:58,690
如计算机视觉或语言、

65
00:03:58,690 --> 00:04:02,170
这一范式并不适用，我们

66
00:04:02,170 --> 00:04:04,610
需要发现不同的数据组合方式。

67
00:04:04,610 --> 00:04:08,450
在接下来的幻灯片中，我们将概述如何

68
00:04:08,450 --> 00:04:11,850
结合不同的数据模式。

69
00:04:11,850 --> 00:04:16,560
存在电子健康数据时、

70
00:04:16,560 --> 00:04:19,138
就像幻灯片中显示的那样，我们会按原样保留记录、

71
00:04:19,138 --> 00:04:23,120
与传统的机器学习格式一样、

72
00:04:23,120 --> 00:04:26,070
采用传统方法。

73
00:04:26,070 --> 00:04:29,790
当有时间序列可用时、

74
00:04:29,790 --> 00:04:31,880
你们稍后在习题课中会看到——

75
00:04:31,880 --> 00:04:34,640
你们会在朗诵中看到

76
00:04:34,640 --> 00:04:38,340
来提取时间序列的特征、

77
00:04:38,340 --> 00:04:41,840
比如最大值、最小值、中位数、

78
00:04:41,840 --> 00:04:45,860
平均值、峰值数量等等。

79
00:04:45,860 --> 00:04:50,390
这样，时间序列就可以用数字来概括了

80
00:04:50,390 --> 00:04:53,210
当输入是医生或护士的笔记/病程记录，或放射科报告（即语言）时，

81
00:04:53,210 --> 00:04:57,000
当输入是医生或护士时

82
00:04:57,000 --> 00:05:00,680
这就是语言、

83
00:05:00,680 --> 00:05:04,410
我们使用的基础模型是 ClinicalBERT。

84
00:05:04,410 --> 00:05:09,420
它以如下格式概括了语言信息

85
00:05:09,420 --> 00:05:12,090
的嵌入，是一个 768 个元素的向量。

86
00:05:12,090 --> 00:05:15,750
该矢量汇总了以下信息

87
00:05:15,750 --> 00:05:18,510
数字格式，可以结合

88
00:05:18,510 --> 00:05:20,940
与其他数字特征。

89
00:05:20,940 --> 00:05:28,530
请注意，我们可以使用生成式人工智能

90
00:05:28,530 --> 00:05:31,870
OpenAI 4.0 或 Llama 等模型，而不是 ClinicalBERT。

91
00:05:31,870 --> 00:05:36,510
当输入为电子心电图时、

92
00:05:36,510 --> 00:05:41,370
我们使用心电图中包含的语言信息、

93
00:05:41,370 --> 00:05:43,260
语言一样，然后使用一个基础模型，如

94
00:05:43,260 --> 00:05:46,770
我们在前面已经看到了 ClinicalBERT、

95
00:05:46,770 --> 00:05:51,610
的格式概括语言信息

96
00:05:51,610 --> 00:05:54,300
的数字格式嵌入一个 768 元素的向量、

97
00:05:54,300 --> 00:05:57,790
和以前一样。

98
00:05:57,790 --> 00:06:02,820
当输入是 X 光之类的图像时、

99
00:06:02,820 --> 00:06:07,050
得到一个由 768 个元素组成的数值向量嵌入。

100
00:06:07,050 --> 00:06:12,300
的 768 元素向量的数字格式。

101
00:06:12,300 --> 00:06:19,590
也可以使用生成式模型产生的嵌入，作为替代于 CNN 提取的图像特征。

102
00:06:19,590 --> 00:06:22,470
而不是使用 CNN 模型的图像作为替代。

103
00:06:22,470 --> 00:06:26,520
这就是讲座的核心思想。

104
00:06:26,520 --> 00:06:29,020
我们直接使用我们开发的数值特征

105
00:06:29,020 --> 00:06:32,730
或从时间序列或文本/图像的嵌入中提取的特征，

106
00:06:32,730 --> 00:06:34,830
或从时间序列或嵌入式中提取特征

107
00:06:34,830 --> 00:06:37,470
使用非结构化数据。

108
00:06:37,470 --> 00:06:41,080
这种想法被称为 "融合"。

109
00:06:41,080 --> 00:06:45,330
我们现在有一项传统的机器学习任务。

110
00:06:45,330 --> 00:06:48,510
例如，我们想用以下方法预测死亡率

111
00:06:48,510 --> 00:06:50,230
将我们提取的数字特征作为输入、

112
00:06:50,230 --> 00:06:54,510
如前所述。

113
00:06:54,510 --> 00:06:58,620
我们使用 XGBoost 或随机森林等传统 ML 模型

114
00:06:58,620 --> 00:07:01,140
来执行这项预测任务。

115
00:07:01,140 --> 00:07:04,180
请注意，该方法非常通用、

116
00:07:04,180 --> 00:07:07,660
因为我们对每种方式都进行了独立处理、

117
00:07:07,660 --> 00:07:11,050
因此，如果我们增加新的模式、

118
00:07:11,050 --> 00:07:15,730
我们只需添加额外的嵌入。

119
00:07:15,730 --> 00:07:19,000
需要注意的是，我们并不对各种模式进行组合训练。

120
00:07:19,000 --> 00:07:21,880
还要注意的是，嵌入并不取决于

121
00:07:21,880 --> 00:07:24,460
我们要执行的任务。

122
00:07:24,460 --> 00:07:29,860
嵌入只是对数据的总结

123
00:07:29,860 --> 00:07:34,780
每种模式都独立于我们要执行的任务。

124
00:07:34,780 --> 00:07:38,860
现在，让我们将 HAIM 应用于各种预测任务，使用

125
00:07:38,860 --> 00:07:43,540
贝斯以色列女执事医疗中心的 MIMIC-IV 数据集

126
00:07:43,540 --> 00:07:51,490
该中心是马萨诸塞州波士顿的一家医院系统。

127
00:07:51,490 --> 00:07:54,850
34,537 份病历数据来自

128
00:07:54,850 --> 00:07:57,940
急诊重症监护室。

129
00:07:57,940 --> 00:08:03,310
记录包括胸部 X 光片、

130
00:08:03,310 --> 00:08:09,500
电子病历、放射记录和心电图。

131
00:08:09,500 --> 00:08:12,600
也就是说，它包括视觉、语言和表格数据。

132
00:08:12,600 --> 00:08:14,990
我们的目标诊断包括 12 个目标

133
00:08:14,990 --> 00:08:19,310
死亡率预测，即我们

134
00:08:19,310 --> 00:08:25,130
旨在预测病人是否死亡或被送往临终关怀机构

135
00:08:25,130 --> 00:08:29,810
10 种诊断之一，即我们要预测患者是否患有

136
00:08:29,810 --> 00:08:37,429
也就是说，我们要预测一个病人是否有 10 项诊断。

137
00:08:37,429 --> 00:08:43,580
纵隔增宽（CM）、实变、肺炎、[听不清]类别、肺

138
00:08:43,580 --> 00:08:49,940
容量、气胸、水肿、心脏增大；最后，

139
00:08:49,940 --> 00:08:52,670
能力、气胸、水肿、心肌肥大；最后、

140
00:08:52,670 --> 00:08:58,340
逗留时间的长短，也就是说，我们希望

141
00:08:58,340 --> 00:09:01,310
来预测病人是否能在 48 小时内出院。

142
00:09:01,310 --> 00:09:04,740
我们比较了 HAIM

143
00:09:04,740 --> 00:09:08,200
以及经典机器学习模型的性能

144
00:09:08,200 --> 00:09:10,020
这只是基于电子病历、

145
00:09:10,020 --> 00:09:16,650
在死亡率预测上，HAIM 相较仅用电子病历的模型将准确率提高了 11% 至 33%。

146
00:09:16,650 --> 00:09:19,120
在死亡率方面，HAIM 可将准确率提高 11% 至 33

147
00:09:19,120 --> 00:09:22,350
与电子病历相比。

148
00:09:22,350 --> 00:09:25,860
这只是基于经典的机器学习模型。

149
00:09:25,860 --> 00:09:30,630
相较仅用电子病历的模型，准确率提高了 6% 至 22%。

150
00:09:30,630 --> 00:09:34,890
与电子记录相比，减少了 6% 至 22%。

151
00:09:34,890 --> 00:09:37,050
在住院时间方面，HAIM 将准确率提高了 8%-20%。

152
00:09:37,050 --> 00:09:39,840
与电子病历相比

153
00:09:39,840 --> 00:09:42,780
和更经典的机器学习模型。

154
00:09:42,780 --> 00:09:47,460
在所有情况下，使用多模式

155
00:09:47,460 --> 00:09:51,300
这一页展示了分组分析，

156
00:09:51,300 --> 00:09:54,900
在本幻灯片中，我们按以下顺序介绍子分析

157
00:09:54,900 --> 00:09:58,270
了解每种模式的相对贡献

158
00:09:58,270 --> 00:10:00,810
对疾病分类的预测。

159
00:10:00,810 --> 00:10:02,820
视觉输入，在这里就是 X 光、

160
00:10:02,820 --> 00:10:05,300
是最主要的模式。

161
00:10:05,300 --> 00:10:10,990
住院时间和死亡率、

162
00:10:10,990 --> 00:10:13,900
时间序列和电子病历

163
00:10:13,900 --> 00:10:18,040
是最主要的模式。

164
00:10:18,040 --> 00:10:22,570
接下来，我们将介绍 HAIM 方法的应用情况

165
00:10:22,570 --> 00:10:28,510
来预测哈特福德医疗保健系统的住院时间、

166
00:10:28,510 --> 00:10:32,080
简称 HHC，是康涅狄格州最大的医院系统、

167
00:10:32,080 --> 00:10:37,300
年营业收入超过 50 亿美元、

168
00:10:37,300 --> 00:10:41,180
七家不同的医院，包括一家城市学术医院

169
00:10:41,180 --> 00:10:45,590
从大型医院到社区医院，从大型医院到小型医院。

170
00:10:45,590 --> 00:10:49,900
HHC 共有 2,500 个床位。

171
00:10:49,900 --> 00:10:52,660
它代表了美国典型的高质量

172
00:10:52,660 --> 00:10:56,170
医院网络。

173
00:10:56,170 --> 00:11:00,020
在一家名为“Holistic Hospital Optimization（医院整体优化）”的公司中落地实现，

174
00:11:00,020 --> 00:11:02,350
在一家名为 "医院整体优化 "的公司工作、

175
00:11:02,350 --> 00:11:04,420
这个简称也寓意与生命最根本的元素——水——的联系。

176
00:11:04,420 --> 00:11:07,840
这表明

177
00:11:07,840 --> 00:11:11,140
我们将详细讨论“住院时长”这一应用。

178
00:11:11,140 --> 00:11:13,330
我们将详细讨论逗留时间的申请。

179
00:11:13,330 --> 00:11:17,230
我们还实施了其他应用、

180
00:11:17,230 --> 00:11:21,670
以及护士排班和手术室排班等。

181
00:11:21,670 --> 00:11:24,580
风险、安排护士和手术室。

182
00:11:24,580 --> 00:11:27,800
数百名用户在使用该软件

183
00:11:27,800 --> 00:11:31,780
医生、护士、行政人员。

184
00:11:31,780 --> 00:11:35,710
它在 HHC 的所有七家医院都能使用、

185
00:11:35,710 --> 00:11:37,390
并使每年的收入增加了数千万美元

186
00:11:37,390 --> 00:11:39,070
美元。

187
00:11:39,070 --> 00:11:43,210
我们已经实施了这些解决方案

188
00:11:43,210 --> 00:11:45,310
全球其他几个医院系统。

189
00:11:45,310 --> 00:11:49,060
这些应用包括预测

190
00:11:49,060 --> 00:11:52,880
在未来 24 或 48 小时内出院，这

191
00:11:52,880 --> 00:11:56,690
这对于识别和优先处理病人非常重要、

192
00:11:56,690 --> 00:12:00,490
缩短住院时间，节省费用、

193
00:12:00,490 --> 00:12:03,100
准备治疗和处置计划。

194
00:12:03,100 --> 00:12:06,050
它还能预测最终目的地

195
00:12:06,050 --> 00:12:09,350
出院后的死亡风险、

196
00:12:09,350 --> 00:12:10,730
科室（ICU）的收治风险。

197
00:12:10,730 --> 00:12:16,340
单位。

198
00:12:16,340 --> 00:12:19,830
这些预测有助于对病人的病情恶化发出警告、

199
00:12:19,830 --> 00:12:23,450
以及更有效地分配医院资源。

200
00:12:23,450 --> 00:12:28,670
表格显示的是 AUC，即曲线下面积、

201
00:12:28,670 --> 00:12:33,080
以及预测进入或离开 ICU 的任务，在 HHC 下属全部七家医院上的 AUC。

202
00:12:33,080 --> 00:12:37,700
预测进入重症监护室或离开重症监护室的所有七种情况

203
00:12:37,700 --> 00:12:41,810
HHC 的医院。

204
00:12:41,810 --> 00:12:44,330
所有预测的结果都非常可靠

205
00:12:44,330 --> 00:12:47,720
和所有医院。

206
00:12:47,720 --> 00:12:49,160
接下来，我们证明校准图也是

207
00:12:49,160 --> 00:12:52,980
具体地，在左侧图中，横轴表示

208
00:12:52,980 --> 00:12:56,420
具体来说，在横轴的左侧图中、

209
00:12:56,420 --> 00:13:01,020
48 小时内出院概率（例如 0.5 到 0.6），

210
00:13:01,020 --> 00:13:06,180
例如，48 小时放电量介于 0.5 和 0.6 之间、

211
00:13:06,180 --> 00:13:09,990
以 10%为单位递增，然后绘制患者比例图

212
00:13:09,990 --> 00:13:11,250
在 48 小时内出院的病人中，纵向

213
00:13:11,250 --> 00:13:15,250
轴。

214
00:13:15,250 --> 00:13:19,380
这条线非常接近 45 度角、

215
00:13:19,380 --> 00:13:21,360
说明预测的概率非常吻合

216
00:13:21,360 --> 00:13:25,570
经验证据。

217
00:13:25,570 --> 00:13:29,490
在右图中，我们看到了死亡率的校准图。

218
00:13:29,490 --> 00:13:32,220
同样，校准也非常准确。

219
00:13:32,220 --> 00:13:34,960
图中显示的软件是

220
00:13:34,960 --> 00:13:38,740
已在 HHC 实施。

221
00:13:38,740 --> 00:13:41,460
绿色表示需要

222
00:13:41,460 --> 00:13:43,720
优先安排该患者出院。

223
00:13:43,720 --> 00:13:47,550
将被优先遣散。

224
00:13:47,550 --> 00:13:51,190
黄色还表示医院人员

225
00:13:51,190 --> 00:13:55,470
需要做准备，但不是以同样的强度。

226
00:13:55,470 --> 00:13:58,530
红色表示患者病情恶化。

227
00:13:58,530 --> 00:14:02,530
如果未来 24 或 48 小时的出院概率超过 50%，则触发绿色警报；

228
00:14:02,530 --> 00:14:04,740
超过 50%。

229
00:14:04,740 --> 00:14:10,360
当 48 小时出院概率介于 35% 与 50% 之间，

230
00:14:10,360 --> 00:14:16,660
如果 48 小时排放概率为

231
00:14:16,660 --> 00:14:19,870
且较前一日上升超过 10% 时，触发黄色警报。

232
00:14:19,870 --> 00:14:23,230
比前一天减少 10%。

233
00:14:23,230 --> 00:14:26,530
软件还绘制了一个子绘图

234
00:14:26,530 --> 00:14:32,020
显示了不同因素对住院时间的影响。

235
00:14:32,020 --> 00:14:36,160
这样，预测的可解释性就强多了。

236
00:14:36,160 --> 00:14:40,690
与人类医生相比，人工智能方法

237
00:14:40,690 --> 00:14:42,910
的 AUC 明显更高，识别

238
00:14:42,910 --> 00:14:45,490
更多的病人可以出院、

239
00:14:45,490 --> 00:14:49,750
并做出更准确的预测。

240
00:14:49,750 --> 00:14:54,670
我们进行了对照测试：HHC 的部分病区使用了该软件，并与未使用的软件病区进行比较，

241
00:14:54,670 --> 00:14:57,940
我们进行了一项测试，在该测试中，香港健康中心的某些病房

242
00:14:57,940 --> 00:14:59,390
已使用该软件并与其他软件进行了比较

243
00:14:59,390 --> 00:15:02,050
没有使用它。

244
00:15:02,050 --> 00:15:05,440
我们发现，患者平均

245
00:15:05,440 --> 00:15:14,350
平均住院时间减少了 0.67 天，从 565 天降至 498 天。

246
00:15:14,350 --> 00:15:16,480
减少了 0.67 天，从 565 天减少到 498 天。

247
00:15:16,480 --> 00:15:20,500
约 15%，

248
00:15:20,500 --> 00:15:24,070
因此，我们

249
00:15:24,070 --> 00:15:27,430
可以相应提高吞吐量、

250
00:15:27,430 --> 00:15:31,180
从而增加医院的总体收入

251
00:15:31,180 --> 00:15:35,650
每年增加数千万。

252
00:15:35,650 --> 00:15:40,180
当前工作包括在布里格姆妇女医院开展的家庭虐待检测，

253
00:15:40,180 --> 00:15:43,780
当前工作的例子包括侦查家庭虐待行为

254
00:15:43,780 --> 00:15:47,110
在马萨总医布里格姆体系内，对病历记录、影像与实验室数据的自动检测，

255
00:15:47,110 --> 00:15:54,460
来自节点、扫描和实验室的数据

256
00:15:54,460 --> 00:15:57,980
马萨诸塞州布里格姆综合医院，哈特福德心电图统一诊断系统

257
00:15:57,980 --> 00:16:00,830
医院，发现硬膜下血肿、

258
00:16:00,830 --> 00:16:06,460
以及所谓的人工智能伴侣。

259
00:16:06,460 --> 00:16:08,310
我们利用 HAIM 向医生和护士提供以下方面的建议

