0
00:00:00,000 --> 00:00:02,120
讲师：在本讲座中，我们介绍

1
00:00:02,120 --> 00:00:08,400
医学整体人工智能，简称 HAIM。

2
00:00:08,400 --> 00:00:11,900
Haim 是犹太语中代表生命的词。

3
00:00:11,900 --> 00:00:17,660
它代表了多模态 AI 在医学中的一种应用。

4
00:00:17,660 --> 00:00:19,800
本讲座的大纲如下。

5
00:00:19,800 --> 00:00:23,670
我们首先给出使用多模态 AI 的动机。

6
00:00:23,670 --> 00:00:27,110
然后我们介绍 HAIM 并将其应用于

7
00:00:27,110 --> 00:00:31,880
Hartford HealthCare 系统的真实环境中。

8
00:00:31,880 --> 00:00:35,030
最后，我们以 HAIM 在医学其他几个领域的应用

9
00:00:35,030 --> 00:00:38,960
作为结束。

10
00:00:38,960 --> 00:00:42,260
为了阐述多模态的动机，

11
00:00:42,260 --> 00:00:45,920
让我们思考一下医生是如何做决定的。

12
00:00:45,920 --> 00:00:52,520
他们利用扫描、MRI、CT、X 射线等；语言，

13
00:00:52,520 --> 00:00:56,670
放射学报告、医生或护士的笔记；

14
00:00:56,670 --> 00:01:00,200
表格数据，例如电子病历；

15
00:01:00,200 --> 00:01:04,290
时间序列；以及基因组信息。

16
00:01:04,290 --> 00:01:07,870
鉴于人类医生使用多模态数据，

17
00:01:07,870 --> 00:01:10,770
很自然地会问机器

18
00:01:10,770 --> 00:01:16,680
是否可以使用多模态数据来进行医学诊断和决策。

19
00:01:16,680 --> 00:01:22,770
考虑一下人类用来理解世界的传感器。

20
00:01:22,770 --> 00:01:26,220
人们使用五种基本的人类感官——

21
00:01:26,220 --> 00:01:32,850
触觉、视觉、听觉、嗅觉和味觉。

22
00:01:32,850 --> 00:01:36,390
换句话说，多模态是

23
00:01:36,390 --> 00:01:38,070
人类生命的一个基本特征。

24
00:01:38,070 --> 00:01:41,910
因此，

25
00:01:41,910 --> 00:01:48,390
考虑机器是否也应该用于多模态数据这个问题是很自然的。

26
00:01:48,390 --> 00:01:52,830
在本讲座中，我们根据 2022 年一篇题为

27
00:01:52,830 --> 00:01:57,960
《Integrated Multimodal

28
00:01:57,960 --> 00:02:00,900
Artificial Intelligence Framework for Healthcare

29
00:02:00,900 --> 00:02:05,810
Applications》（用于医疗保健应用的综合多模态人工智能框架）的论文的主要发现来介绍 HAIM，

30
00:02:05,810 --> 00:02:10,850
该论文由我和我的研究小组成员发表于 2022 年 9 月的《Nature Digital Medicine》上。

31
00:02:10,850 --> 00:02:13,520
我想告诉你们一点

32
00:02:13,520 --> 00:02:15,650
关于 HAIM 构想的历史。

33
00:02:15,650 --> 00:02:22,160
2013 年，IBM 创建了 Watson，这是一个可以参加 Jeopardy 比赛的计算机程序，

34
00:02:22,160 --> 00:02:24,770
在这个游戏中，

35
00:02:24,770 --> 00:02:29,180
参赛者会得到一个陈述，

36
00:02:29,180 --> 00:02:31,250
她需要以答案

37
00:02:31,250 --> 00:02:33,350
以问题的形式。

38
00:02:33,350 --> 00:02:38,660
例如，如果答案是“他提出了相对论”，

39
00:02:38,660 --> 00:02:42,710
参赛者需要说

40
00:02:42,710 --> 00:02:44,990
“谁是阿尔伯特·爱因斯坦？”才能算作正确回答。

41
00:02:44,990 --> 00:02:49,490
IBM Watson 与历史上最好的人类选手进行了为期两天的比赛，

42
00:02:49,490 --> 00:02:54,680
并且它以绝对优势获胜。

43
00:02:54,680 --> 00:02:58,710
我记得对这一事件的兴奋，

44
00:02:58,710 --> 00:03:01,220
因为我当时知道这是

45
00:03:01,220 --> 00:03:03,910
将机器智能推向新水平的

46
00:03:03,910 --> 00:03:06,190
时代的开始。

47
00:03:06,190 --> 00:03:09,740
IBM 接着将 Watson 应用于医学，

48
00:03:09,740 --> 00:03:12,550
不幸的是没有成功。

49
00:03:12,550 --> 00:03:15,640
在这期间的 12 年里，人工智能

50
00:03:15,640 --> 00:03:19,090
取得了显著进步，特别是生成式 AI

51
00:03:19,090 --> 00:03:21,460
和大型语言模型。

52
00:03:21,460 --> 00:03:24,970
HAIM 展示了如何结合各种模态

53
00:03:24,970 --> 00:03:29,170
以实现显著提高的性能。

54
00:03:29,170 --> 00:03:32,780
HAIM 提出了 AI 的整体视角——

55
00:03:32,780 --> 00:03:35,000
计算机视觉、自然语言处理，

56
00:03:35,000 --> 00:03:38,170
机器学习——以提高模型

57
00:03:38,170 --> 00:03:40,820
进行预测和处方的能力，

58
00:03:40,820 --> 00:03:44,230
特别是在医学领域。

59
00:03:44,230 --> 00:03:47,560
传统的机器学习范式

60
00:03:47,560 --> 00:03:51,400
是使用表格数据进行预测。

61
00:03:51,400 --> 00:03:53,780
当存在多种模态时，

62
00:03:53,780 --> 00:03:56,480
如计算机视觉或语言，

63
00:03:56,480 --> 00:03:58,690
这种范式就不适用了，我们

64
00:03:58,690 --> 00:04:02,170
需要发现结合数据的不同方法。

65
00:04:02,170 --> 00:04:04,610
在接下来的幻灯片中，

66
00:04:04,610 --> 00:04:08,450
我们概述如何结合不同模态的数据。

67
00:04:08,450 --> 00:04:11,850
当存在电子健康数据时，

68
00:04:11,850 --> 00:04:16,560
如幻灯片中所示的那样，

69
00:04:16,560 --> 00:04:19,138
我们保持记录的原样，

70
00:04:19,138 --> 00:04:23,120
因为它们处于传统的机器学习格式中，

71
00:04:23,120 --> 00:04:26,070
传统方法适用于此。

72
00:04:26,070 --> 00:04:29,790
当有时间序列可用时，

73
00:04:29,790 --> 00:04:31,880
我们使用像 tsfresh 这样的软件——

74
00:04:31,880 --> 00:04:34,640
你们现在将在习题课中看到——

75
00:04:34,640 --> 00:04:38,340
来提取时间序列的特征，

76
00:04:38,340 --> 00:04:41,840
如最大值、最小值、中位数、平均值、峰值数量等。

77
00:04:41,840 --> 00:04:45,860
通过这种方式，时间序列被总结为数字

78
00:04:45,860 --> 00:04:50,390
这些数字是传统机器学习格式的输入。

79
00:04:50,390 --> 00:04:53,210
当输入是医生或护士

80
00:04:53,210 --> 00:04:57,000
的笔记或放射学报告（即语言）时，

81
00:04:57,000 --> 00:05:00,680
我们使用像 ClinicalBERT 这样的基础模型。

82
00:05:00,680 --> 00:05:04,410
这将语言信息总结为嵌入的格式，

83
00:05:04,410 --> 00:05:09,420
即一个 768 元素的向量。

84
00:05:09,420 --> 00:05:12,090
该向量以数字格式总结信息，

85
00:05:12,090 --> 00:05:15,750
可以与其他数字特征

86
00:05:15,750 --> 00:05:18,510
相结合。

87
00:05:18,510 --> 00:05:20,940
请注意，我们可以使用生成式 AI

88
00:05:20,940 --> 00:05:28,530
模型，如 OpenAI 4.0 或 Llama，

89
00:05:28,530 --> 00:05:31,870
来代替 ClinicalBERT。

90
00:05:31,870 --> 00:05:36,510
当输入是电子心电图时，

91
00:05:36,510 --> 00:05:41,370
我们使用 EKG 中包含的语言信息，

92
00:05:41,370 --> 00:05:43,260
就像语言一样，然后使用像

93
00:05:43,260 --> 00:05:46,770
ClinicalBERT 这样的基础模型（我们之前见过的），

94
00:05:46,770 --> 00:05:51,610
它将语言信息总结为 768 元素向量的嵌入格式，

95
00:05:51,610 --> 00:05:54,300
即数字格式，如前所述。

96
00:05:54,300 --> 00:05:57,790
当输入是像 X 光片这样的图像时，

97
00:05:57,790 --> 00:06:02,820
我们使用卷积神经网络来提取

98
00:06:02,820 --> 00:06:07,050
数字格式的 768 元素向量的嵌入。

99
00:06:07,050 --> 00:06:12,300
请注意，我们可以使用来自生成式 AI 模型的嵌入，

100
00:06:12,300 --> 00:06:19,590
而不是使用来自 CNN 模型的图像

101
00:06:19,590 --> 00:06:22,470
作为替代方案。

102
00:06:22,470 --> 00:06:26,520
这是本讲座的关键思想。

103
00:06:26,520 --> 00:06:29,020
我们使用我们开发的数字特征，

104
00:06:29,020 --> 00:06:32,730
无论是直接来自电子医疗记录，

105
00:06:32,730 --> 00:06:34,830
还是从时间序列提取的特征，或者是使用非结构化数据的嵌入。

106
00:06:34,830 --> 00:06:37,470
这个想法被称为融合。

107
00:06:37,470 --> 00:06:41,080
我们现在有了一个传统的机器学习任务。

108
00:06:41,080 --> 00:06:45,330
我们想要预测，比如说，死亡率，使用

109
00:06:45,330 --> 00:06:48,510
我们提取的数字特征作为输入，

110
00:06:48,510 --> 00:06:50,230
如前所述。

111
00:06:50,230 --> 00:06:54,510
我们使用像 XGBoost 或随机森林这样的传统 ML 模型

112
00:06:54,510 --> 00:06:58,620
来执行此预测任务。

113
00:06:58,620 --> 00:07:01,140
请注意，该方法非常通用，

114
00:07:01,140 --> 00:07:04,180
因为我们独立处理每种模态，

115
00:07:04,180 --> 00:07:07,660
因此如果我们添加新模态，

116
00:07:07,660 --> 00:07:11,050
我们只需添加额外的嵌入。

117
00:07:11,050 --> 00:07:15,730
请注意，

118
00:07:15,730 --> 00:07:19,000
我们不组合训练这些模态。

119
00:07:19,000 --> 00:07:21,880
还要注意，嵌入不取决于

120
00:07:21,880 --> 00:07:24,460
我们要执行的任务。

121
00:07:24,460 --> 00:07:29,860
嵌入只是独立于我们要执行的任务总结每种模态的数据。

122
00:07:29,860 --> 00:07:34,780
现在让我们使用

123
00:07:34,780 --> 00:07:38,860
来自马萨诸塞州波士顿的医院系统

124
00:07:38,860 --> 00:07:43,540
Beth Israel Deaconess Medical Center 的 MIMIC-IV 数据集，

125
00:07:43,540 --> 00:07:51,490
将 HAIM 应用于各种预测任务。

126
00:07:51,490 --> 00:07:54,850
包含 34,537 条患者记录的数据集

127
00:07:54,850 --> 00:07:57,940
来自急诊 ICU 病房。

128
00:07:57,940 --> 00:08:03,310
记录包括胸部 X 光片，

129
00:08:03,310 --> 00:08:09,500
电子病历、放射学笔记和 EKG。

130
00:08:09,500 --> 00:08:12,600
也就是说，它包括视觉、语言和表格数据。

131
00:08:12,600 --> 00:08:14,990
我们的目标诊断包括 12 个目标——

132
00:08:14,990 --> 00:08:19,310
死亡率预测，也就是说，

133
00:08:19,310 --> 00:08:25,130
我们的目标是预测患者是否死亡或被送往临终关怀机构，

134
00:08:25,130 --> 00:08:29,810
或者患者在出院时是否存活；

135
00:08:29,810 --> 00:08:37,429
10 种诊断之一，也就是说，

136
00:08:37,429 --> 00:08:43,580
我们要预测患者是否患有某种疾病，

137
00:08:43,580 --> 00:08:49,940
如骨折、肺部病变、CM 扩大、实变、肺炎、[听不清] 类别、肺活量、气胸、水肿、心脏肥大；

138
00:08:49,940 --> 00:08:52,670
最后是住院时间，也就是说，

139
00:08:52,670 --> 00:08:58,340
我们要预测患者是否在 48 小时内离开医院。

140
00:08:58,340 --> 00:09:01,310
我们比较了 HAIM 的性能

141
00:09:01,310 --> 00:09:04,740
和仅基于电子病历的经典机器学习模型的性能，

142
00:09:04,740 --> 00:09:08,200
即经典方法。

143
00:09:08,200 --> 00:09:10,020
在死亡率方面，

144
00:09:10,020 --> 00:09:16,650
HAIM 将准确率提高了 11% 到 33%，

145
00:09:16,650 --> 00:09:19,120
与电子病历相比。

146
00:09:19,120 --> 00:09:22,350
那是仅基于经典机器学习模型的。

147
00:09:22,350 --> 00:09:25,860
在疾病分类方面，

148
00:09:25,860 --> 00:09:30,630
与电子记录相比，HAIM 将准确率提高了 6% 到 22%。

149
00:09:30,630 --> 00:09:34,890
在住院时间方面，

150
00:09:34,890 --> 00:09:37,050
与电子病历和更经典的机器学习模型相比，

151
00:09:37,050 --> 00:09:39,840
HAIM 将准确率提高了 8% 到 20%。

152
00:09:39,840 --> 00:09:42,780
在所有情况下，

153
00:09:42,780 --> 00:09:47,460
多模态的使用都导致了

154
00:09:47,460 --> 00:09:51,300
性能的显著提高。

155
00:09:51,300 --> 00:09:54,900
在这张幻灯片中，

156
00:09:54,900 --> 00:09:58,270
我们展示了子分析，

157
00:09:58,270 --> 00:10:00,810
以了解每种模态对疾病分类预测的相对贡献。

158
00:10:00,810 --> 00:10:02,820
视觉输入，在这种情况下是 X 光片，

159
00:10:02,820 --> 00:10:05,300
是主导模态。

160
00:10:05,300 --> 00:10:10,990
对于住院时间和死亡率，

161
00:10:10,990 --> 00:10:13,900
时间序列和电子病历

162
00:10:13,900 --> 00:10:18,040
是主导模态。

163
00:10:18,040 --> 00:10:22,570
接下来，我们介绍 HAIM 方法论的一个应用，

164
00:10:22,570 --> 00:10:28,510
用于预测 Hartford Health Care 系统（简称 HHC）的住院时间，

165
00:10:28,510 --> 00:10:32,080
这是康涅狄格州最大的医院系统，

166
00:10:32,080 --> 00:10:37,300
年营业收入超过 50 亿美元，

167
00:10:37,300 --> 00:10:41,180
拥有七家多样化的医院，

168
00:10:41,180 --> 00:10:45,590
范围从学术性城市医院到社区医院，从大型医院到小型医院。

169
00:10:45,590 --> 00:10:49,900
HHC 总共拥有 2,500 张床位。

170
00:10:49,900 --> 00:10:52,660
它是高质量、典型的美国医院网络的

171
00:10:52,660 --> 00:10:56,170
代表。

172
00:10:56,170 --> 00:11:00,020
我们已经在一家名为 Holistic Hospital Optimization

173
00:11:00,020 --> 00:11:02,350
（简称 H2O）的公司中实施了

174
00:11:02,350 --> 00:11:04,420
我们介绍的一些算法。

175
00:11:04,420 --> 00:11:07,840
这表明了与生命的基本方面——

176
00:11:07,840 --> 00:11:11,140
水——的联系。

177
00:11:11,140 --> 00:11:13,330
我们详细讨论住院时间的应用。

178
00:11:13,330 --> 00:11:17,230
我们已经实施了其他应用，

179
00:11:17,230 --> 00:11:21,670
如恶化指数，其中包括死亡风险、ICU 风险、护士排班和手术室排班。

180
00:11:21,670 --> 00:11:24,580
该软件被数百名用户使用——

181
00:11:24,580 --> 00:11:27,800
医生、护士、管理员。

182
00:11:27,800 --> 00:11:31,780
它在 HHC 的所有七家医院运行，

183
00:11:31,780 --> 00:11:35,710
并带来了数千万美元的

184
00:11:35,710 --> 00:11:37,390
年收入增长。

185
00:11:37,390 --> 00:11:39,070
我们已经将这些解决方案实施到

186
00:11:39,070 --> 00:11:43,210
世界各地的其他几个

187
00:11:43,210 --> 00:11:45,310
医院系统中。

188
00:11:45,310 --> 00:11:49,060
这些应用包括预测

189
00:11:49,060 --> 00:11:52,880
未来 24 或 48 小时内的出院，

190
00:11:52,880 --> 00:11:56,690
这对于识别和优先处理患者、减少住院时间、节省成本、准备治疗和处置计划

191
00:11:56,690 --> 00:12:00,490
非常重要。

192
00:12:00,490 --> 00:12:03,100
它还预测出院后的最终去向，

193
00:12:03,100 --> 00:12:06,050
死亡风险，

194
00:12:06,050 --> 00:12:09,350
以及需要入住重症监护病房的

195
00:12:09,350 --> 00:12:10,730
风险。

196
00:12:10,730 --> 00:12:16,340
这些预测有助于预警患者的恶化，

197
00:12:16,340 --> 00:12:19,830
以及更有效地分配

198
00:12:19,830 --> 00:12:23,450
医院资源。

199
00:12:23,450 --> 00:12:28,670
该表描绘了 AUC（曲线下面积），

200
00:12:28,670 --> 00:12:33,080
用于死亡率、去向、24 和 48 小时出院，

201
00:12:33,080 --> 00:12:37,700
预测进入 ICU 或离开 ICU，适用于 HHC 所有七家医院。

202
00:12:37,700 --> 00:12:41,810
结果在所有预测

203
00:12:41,810 --> 00:12:44,330
和所有医院中都

204
00:12:44,330 --> 00:12:47,720
可靠地强劲。

205
00:12:47,720 --> 00:12:49,160
接下来我们证明

206
00:12:49,160 --> 00:12:52,980
校准图也非常准确。

207
00:12:52,980 --> 00:12:56,420
具体来说，在左侧图的水平轴上，

208
00:12:56,420 --> 00:13:01,020
我们绘制了 48 小时出院概率在（比如说）0.5 到 0.6 之间的患者比例，

209
00:13:01,020 --> 00:13:06,180
增量为 10%，

210
00:13:06,180 --> 00:13:09,990
然后在垂直轴上绘制

211
00:13:09,990 --> 00:13:11,250
这些患者中在 48 小时内出院的比例。

212
00:13:11,250 --> 00:13:15,250
这条线非常接近 45 度角，

213
00:13:15,250 --> 00:13:19,380
说明预测概率

214
00:13:19,380 --> 00:13:21,360
与经验证据紧密匹配。

215
00:13:21,360 --> 00:13:25,570
在右侧图中，我们看到了死亡率的校准图。

216
00:13:25,570 --> 00:13:29,490
同样，校准非常准确。

217
00:13:29,490 --> 00:13:32,220
该图显示了

218
00:13:32,220 --> 00:13:34,960
已在 HHC 实施的软件。

219
00:13:34,960 --> 00:13:38,740
颜色展示了以下信息。

220
00:13:38,740 --> 00:13:41,460
绿色建议

221
00:13:41,460 --> 00:13:43,720
需要优先考虑患者出院。

222
00:13:43,720 --> 00:13:47,550
黄色也表示医院人员

223
00:13:47,550 --> 00:13:51,190
需要做准备，

224
00:13:51,190 --> 00:13:55,470
但强度水平不同。

225
00:13:55,470 --> 00:13:58,530
红色表示患者正在恶化。

226
00:13:58,530 --> 00:14:02,530
请注意，

227
00:14:02,530 --> 00:14:04,740
如果未来 24 小时或 48 小时的出院概率超过 50%，

228
00:14:04,740 --> 00:14:10,360
我们会分配一个绿色警报。

229
00:14:10,360 --> 00:14:16,660
如果 48 小时出院概率在 35% 到 50% 之间，

230
00:14:16,660 --> 00:14:19,870
并且概率比前一天增加超过 10%，

231
00:14:19,870 --> 00:14:23,230
则会出现黄色警报。

232
00:14:23,230 --> 00:14:26,530
该软件还绘制了一个子图，

233
00:14:26,530 --> 00:14:32,020
显示不同因素如何影响住院时间。

234
00:14:32,020 --> 00:14:36,160
这样，预测就更具可解释性。

235
00:14:36,160 --> 00:14:40,690
与人类医生相比，人工智能方法

236
00:14:40,690 --> 00:14:42,910
具有显著更高的 AUC，能识别更多可以出院的患者，

237
00:14:42,910 --> 00:14:45,490
并做出更准确的预测。

238
00:14:45,490 --> 00:14:49,750
显然，AI 的优势是显著的。

239
00:14:49,750 --> 00:14:54,670
我们进行了一项测试，

240
00:14:54,670 --> 00:14:57,940
其中 HHC 的某些病房使用了该软件，

241
00:14:57,940 --> 00:14:59,390
并将其与未使用该软件的

242
00:14:59,390 --> 00:15:02,050
其他病房进行了比较。

243
00:15:02,050 --> 00:15:05,440
我们发现，使用该软件的单位的平均患者住院时间减少了 0.67 天，

244
00:15:05,440 --> 00:15:14,350
从 565 天减少到 498 天。

245
00:15:14,350 --> 00:15:16,480
这表明我们将住院时间减少了大约 15%，

246
00:15:16,480 --> 00:15:20,500
因此我们可以相应地增加吞吐量，

247
00:15:20,500 --> 00:15:24,070
从而使医院的年总收入

248
00:15:24,070 --> 00:15:27,430
增加数千万。

249
00:15:27,430 --> 00:15:31,180


250
00:15:31,180 --> 00:15:35,650
HAIM 广泛适用于各种应用。

251
00:15:35,650 --> 00:15:40,180
当前工作的例子包括在 Brigham and Women's Hospital 检测家庭虐待，

252
00:15:40,180 --> 00:15:43,780
在 Mass General Brigham 自动检测来自节点、扫描和实验室的数据，

253
00:15:43,780 --> 00:15:47,110
在 Hartford Hospital 进行 EKG 的统一诊断，

254
00:15:47,110 --> 00:15:54,460
检测硬膜下血肿，

255
00:15:54,460 --> 00:15:57,980
以及所谓的 AI 伴侣。

256
00:15:57,980 --> 00:16:00,830
我们利用 HAIM 就诊断

257
00:16:00,830 --> 00:16:06,460
向医生和护士提供

258
00:16:06,460 --> 00:16:08,310
建议。

